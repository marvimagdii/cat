"use strict";!function(t){var e,r,n=(e={},function(t){function r(t,e){return t.length>e&&(t=t.substring(0,e)+ellipsis),t}function n(t,e){t instanceof n?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=e)}function i(t,e,r,n,i){if(!(n instanceof s))throw"Invalid tag value.";this.stream=t,this.header=e,this.length=r,this.tag=n,this.sub=i}function s(t){var e=t.get();if(this.tagClass=e>>6,this.tagConstructed=0!=(32&e),this.tagNumber=31&e,31==this.tagNumber)throw"Long Tag 0x1F not supported at position "+(t.pos-1)}n.prototype.get=function(e){if(e===t&&(e=this.pos++),e>=this.enc.length)throw"Requesting byte offset "+e+" on a stream of length "+this.enc.length;return this.enc[e]},n.prototype.hexDigits="0123456789ABCDEF",n.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},n.prototype.hexDump=function(t,e,r){for(var n="",i=t;i<e;++i)if(n+=this.hexByte(this.get(i)),!0!==r)switch(15&i){case 7:n+="  ";break;case 15:n+="\n";break;default:n+=" "}return n},i.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},i.prototype.content=function(e){if(this.tag===t)return null;e===t&&(e=1/0);var n=this.posContent(),i=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(n,n+i,e);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(n)?"false":"true";case 2:return this.stream.parseInteger(n,n+i);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(n,n+i,e);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(n,n+i,e);case 6:return this.stream.parseOID(n,n+i,e);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return r(this.stream.parseStringUTF(n,n+i),e);case 18:case 19:case 20:case 21:case 22:case 26:return r(this.stream.parseStringISO(n,n+i),e);case 30:return r(this.stream.parseStringBMP(n,n+i),e);case 23:case 24:return this.stream.parseTime(n,n+i,23==this.tag.tagNumber)}return null},i.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},i.prototype.posStart=function(){return this.stream.pos},i.prototype.posContent=function(){return this.stream.pos+this.header},i.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},i.prototype.toHexString=function(t){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},i.decodeLength=function(t){var e=t.get(),r=127&e;if(r==e)return r;if(r>6)throw"Length over 48 bits not supported at position "+(t.pos-1);if(0===r)return null;e=0;for(var n=0;n<r;++n)e=256*e+t.get();return e},s.prototype.isUniversal=function(){return 0===this.tagClass},s.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},i.decode=function(t){t instanceof n||(t=new n(t,0));var e=new n(t),r=new s(t),a=i.decodeLength(t),o=t.pos,h=o-e.pos,c=null,u=function(){if(c=[],null!==a){for(var e=o+a;t.pos<e;)c[c.length]=i.decode(t);if(t.pos!=e)throw"Content size is not correct for container starting at offset "+o}else try{for(;;){var r=i.decode(t);if(r.tag.isEOC())break;c[c.length]=r}a=o-t.pos}catch(t){throw"Exception while decoding undefined length content: "+t}};if(r.tagConstructed)u();else if(r.isUniversal()&&(3==r.tagNumber||4==r.tagNumber)){3==r.tagNumber&&t.get();try{u();for(var l=0;l<c.length;++l)if(c[l].tag.isEOC())throw"EOC is not supposed to be actual content."}catch(t){c=null}}if(null===c){if(null===a)throw"We can't skip over an invalid tag with undefined length at offset "+o;t.pos=o+Math.abs(a)}return new i(e,h,a,r,c)},"undefined"!=typeof module?module.exports=i:e.ASN1=i}(),e.ASN1),i=(r={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}},"undefined"!=typeof module&&module.exports&&(module.exports=r),r.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,n,i,s,a,o=this._tables[0][4],h=this._tables[1],c=t.length,u=1;if(4!==c&&6!==c&&8!==c)throw new r.exception.invalid("invalid aes key size");for(this._key=[s=t.slice(0),a=[]],e=c;e<4*c+28;e++)i=s[e-1],(e%c==0||8===c&&e%c==4)&&(i=o[i>>>24]<<24^o[i>>16&255]<<16^o[i>>8&255]<<8^o[255&i],e%c==0&&(i=i<<8^i>>>24^u<<24,u=u<<1^283*(u>>7))),s[e]=s[e-c]^i;for(n=0;e;n++,e--)i=s[3&n?e:e-4],a[n]=e<=4||n<4?i:h[0][o[i>>>24]]^h[1][o[i>>16&255]]^h[2][o[i>>8&255]]^h[3][o[255&i]]},r.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,r,n,i,s,a,o,h=this._tables[0],c=this._tables[1],u=h[4],l=c[4],p=[],f=[];for(t=0;t<256;t++)f[(p[t]=t<<1^283*(t>>7))^t]=t;for(e=r=0;!u[e];e^=n||1,r=f[r]||1)for(s=(s=r^r<<1^r<<2^r<<3^r<<4)>>8^255&s^99,u[e]=s,l[s]=e,o=16843009*p[i=p[n=p[e]]]^65537*i^257*n^16843008*e,a=257*p[s]^16843008*s,t=0;t<4;t++)h[t][e]=a=a<<24^a>>>8,c[t][s]=o=o<<24^o>>>8;for(t=0;t<5;t++)h[t]=h[t].slice(0),c[t]=c[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new r.exception.invalid("invalid aes block size");var n,i,s,a,o=this._key[e],h=t[0]^o[0],c=t[e?3:1]^o[1],u=t[2]^o[2],l=t[e?1:3]^o[3],p=o.length/4-2,f=4,d=[0,0,0,0],v=this._tables[e],m=v[0],g=v[1],y=v[2],b=v[3],_=v[4];for(a=0;a<p;a++)n=m[h>>>24]^g[c>>16&255]^y[u>>8&255]^b[255&l]^o[f],i=m[c>>>24]^g[u>>16&255]^y[l>>8&255]^b[255&h]^o[f+1],s=m[u>>>24]^g[l>>16&255]^y[h>>8&255]^b[255&c]^o[f+2],l=m[l>>>24]^g[h>>16&255]^y[c>>8&255]^b[255&u]^o[f+3],f+=4,h=n,c=i,u=s;for(a=0;a<4;a++)d[e?3&-a:a]=_[h>>>24]<<24^_[c>>16&255]<<16^_[u>>8&255]<<8^_[255&l]^o[f++],n=h,h=c,c=u,u=l,l=n;return d}},r.bitArray={bitSlice:function(t,e,n){return t=r.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===n?t:r.bitArray.clamp(t,n-e)},extract:function(t,e,r){var n=Math.floor(-e-r&31);return(-32&(e+r-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n)&(1<<r)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var n=t[t.length-1],i=r.bitArray.getPartial(n);return 32===i?t.concat(e):r.bitArray._shiftRight(e,i,0|n,t.slice(0,t.length-1))},bitLength:function(t){var e,n=t.length;return 0===n?0:(e=t[n-1],32*(n-1)+r.bitArray.getPartial(e))},clamp:function(t,e){if(32*t.length<e)return t;var n=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,n>0&&e&&(t[n-1]=r.bitArray.partial(e,t[n-1]&2147483648>>e-1,1)),t},partial:function(t,e,r){return 32===t?e:(r?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(r.bitArray.bitLength(t)!==r.bitArray.bitLength(e))return!1;var n,i=0;for(n=0;n<t.length;n++)i|=t[n]^e[n];return 0===i},_shiftRight:function(t,e,n,i){var s,a,o;for(void 0===i&&(i=[]);e>=32;e-=32)i.push(n),n=0;if(0===e)return i.concat(t);for(s=0;s<t.length;s++)i.push(n|t[s]>>>e),n=t[s]<<32-e;return a=t.length?t[t.length-1]:0,o=r.bitArray.getPartial(a),i.push(r.bitArray.partial(e+o&31,e+o>32?n:i.pop(),1)),i},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},r.codec.utf8String={fromBits:function(t){var e,n,i="",s=r.bitArray.bitLength(t);for(e=0;e<s/8;e++)0==(3&e)&&(n=t[e/4]),i+=String.fromCharCode(n>>>24),n<<=8;return decodeURIComponent(escape(i))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,n=[],i=0;for(e=0;e<t.length;e++)i=i<<8|t.charCodeAt(e),3==(3&e)&&(n.push(i),i=0);return 3&e&&n.push(r.bitArray.partial(8*(3&e),i)),n}},r.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,n){var i,s="",a=0,o=r.codec.base64._chars,h=0,c=r.bitArray.bitLength(t);for(n&&(o=o.substr(0,62)+"-_"),i=0;6*s.length<c;)s+=o.charAt((h^t[i]>>>a)>>>26),a<6?(h=t[i]<<6-a,a+=26,i++):(h<<=6,a-=6);for(;3&s.length&&!e;)s+="=";return s},toBits:function(t,e){t=t.replace(/\s|=/g,"");var n,i,s=[],a=0,o=r.codec.base64._chars,h=0;for(e&&(o=o.substr(0,62)+"-_"),n=0;n<t.length;n++){if((i=o.indexOf(t.charAt(n)))<0)throw new r.exception.invalid("this isn't base64!");a>26?(a-=26,s.push(h^i>>>a),h=i<<32-a):h^=i<<32-(a+=6)}return 56&a&&s.push(r.bitArray.partial(56&a,h,1)),s}},r.codec.base64url={fromBits:function(t){return r.codec.base64.fromBits(t,1,1)},toBits:function(t){return r.codec.base64.toBits(t,1)}},void 0===r.beware&&(r.beware={}),r.beware["CBC mode is dangerous because it doesn't protect message integrity."]=r.beware["CBC mode warning"]=function(){r.mode.cbc={name:"cbc",encrypt:function(t,e,n,i){if(i&&i.length)throw new r.exception.invalid("cbc can't authenticate data");if(128!==r.bitArray.bitLength(n))throw new r.exception.invalid("cbc iv must be 128 bits");var s,a=r.bitArray,o=a._xor4,h=a.bitLength(e),c=0,u=[];if(7&h)throw new r.exception.invalid("pkcs#5 padding only works for multiples of a byte");for(s=0;c+128<=h;s+=4,c+=128)n=t.encrypt(o(n,e.slice(s,s+4))),u.splice(s,0,n[0],n[1],n[2],n[3]);return h=16843009*(16-(h>>3&15)),n=t.encrypt(o(n,a.concat(e,[h,h,h,h]).slice(s,s+4))),u.splice(s,0,n[0],n[1],n[2],n[3]),u}}},r.misc.hmac=function(t,e){this._hash=e=e||r.hash.sha256;var n,i=[[],[]],s=e.prototype.blockSize/32;for(this._baseHash=[new e,new e],t.length>s&&(t=e.hash(t)),n=0;n<s;n++)i[0][n]=909522486^t[n],i[1][n]=1549556828^t[n];this._baseHash[0].update(i[0]),this._baseHash[1].update(i[1])},r.misc.hmac.prototype.encrypt=r.misc.hmac.prototype.mac=function(t){var e=new this._hash(this._baseHash[0]).update(t).finalize();return new this._hash(this._baseHash[1]).update(e).finalize()},r.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},r.hash.sha256.hash=function(t){return(new r.hash.sha256).update(t).finalize()},r.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=r.codec.utf8String.toBits(t));var e,n=this._buffer=r.bitArray.concat(this._buffer,t),i=this._length,s=this._length=i+r.bitArray.bitLength(t);for(e=512+i&-512;e<=s;e+=512)this._block(n.splice(0,16));return this},finalize:function(){var t,e=this._buffer,n=this._h;for(t=(e=r.bitArray.concat(e,[r.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),n},_init:[],_key:[],_precompute:function(){var t,e=0,r=2;function n(t){return 4294967296*(t-Math.floor(t))|0}t:for(;e<64;r++){for(t=2;t*t<=r;t++)if(r%t==0)continue t;e<8&&(this._init[e]=n(Math.pow(r,.5))),this._key[e]=n(Math.pow(r,1/3)),e++}},_block:function(t){var e,r,n,i,s=t.slice(0),a=this._h,o=this._key,h=a[0],c=a[1],u=a[2],l=a[3],p=a[4],f=a[5],d=a[6],v=a[7];for(e=0;e<64;e++)e<16?r=s[e]:(n=s[e+1&15],i=s[e+14&15],r=s[15&e]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+s[15&e]+s[e+9&15]|0),r=r+v+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(d^p&(f^d))+o[e],v=d,d=f,f=p,p=l+r|0,l=u,u=c,h=r+((c=h)&u^l&(c^u))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;a[0]=a[0]+h|0,a[1]=a[1]+c|0,a[2]=a[2]+u|0,a[3]=a[3]+l|0,a[4]=a[4]+p|0,a[5]=a[5]+f|0,a[6]=a[6]+d|0,a[7]=a[7]+v|0}},r.prng=function(t){this._pools=[new r.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},r.prng.prototype={randomWords:function(t,e){var n,i,s=[],a=this.isReady(e);if(a===this._NOT_READY)throw new r.exception.notReady("generator isn't seeded");for(a&this._REQUIRES_RESEED&&this._reseedFromPools(!(a&this._READY)),n=0;n<t;n+=4)(n+1)%this._MAX_WORDS_PER_BURST==0&&this._gate(),i=this._gen4words(),s.push(i[0],i[1],i[2],i[3]);return this._gate(),s.slice(0,t)},setDefaultParanoia:function(t){this._defaultParanoia=t},addEntropy:function(t,e,n){n=n||"user";var i,s,a,o=(new Date).valueOf(),h=this._robins[n],c=this.isReady(),u=0;switch(void 0===(i=this._collectorIds[n])&&(i=this._collectorIds[n]=this._collectorIdNext++),void 0===h&&(h=this._robins[n]=0),this._robins[n]=(this._robins[n]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[h].update([i,this._eventId++,1,e,o,1,0|t]);break;case"object":var l=Object.prototype.toString.call(t);if("[object Uint32Array]"===l){for(a=[],s=0;s<t.length;s++)a.push(t[s]);t=a}else for("[object Array]"!==l&&(u=1),s=0;s<t.length&&!u;s++)"number"!=typeof t[s]&&(u=1);if(!u){if(void 0===e)for(e=0,s=0;s<t.length;s++)for(a=t[s];a>0;)e++,a>>>=1;this._pools[h].update([i,this._eventId++,2,e,o,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[h].update([i,this._eventId++,3,e,o,t.length]),this._pools[h].update(t);break;default:u=1}if(u)throw new r.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[h]+=e,this._poolStrength+=e,c===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t||this._defaultParanoia];return this._strength>=e?1:this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(t.addEventListener)t.addEventListener("load",this._loadTimeCollector,!1),t.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw new r.exception.bug("can't attach event");document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(t.removeEventListener?(t.removeEventListener("load",this._loadTimeCollector,!1),t.removeEventListener("mousemove",this._mouseCollector,!1)):t.detachEvent&&(t.detachEvent("onload",this._loadTimeCollector),t.detachEvent("onmousemove",this._mouseCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var r,n,i=this._callbacks[t],s=[];for(n in i)i.hasOwnProperty(n)&&i[n]===e&&s.push(n);for(r=0;r<s.length;r++)delete i[n=s[r]]},_gen4words:function(){for(var t=0;t<4&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new r.cipher.aes(this._key)},_reseed:function(t){this._key=r.hash.sha256.hash(this._key.concat(t)),this._cipher=new r.cipher.aes(this._key);for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,n=[],i=0;for(this._nextReseed=n[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;e<16;e++)n.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(n=n.concat(this._pools[e].finalize()),i+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new r.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=i,i>this._strength&&(this._strength=i),this._reseedCount++,this._reseed(n)},_mouseCollector:function(t){var e=t.x||t.clientX||t.offsetX||0,n=t.y||t.clientY||t.offsetY||0;r.random.addEntropy([e,n],2,"mouse")},_loadTimeCollector:function(t){r.random.addEntropy((new Date).valueOf(),2,"loadtime")},_fireEvent:function(t,e){var n,i=r.random._callbacks[t],s=[];for(n in i)i.hasOwnProperty(n)&&s.push(i[n]);for(n=0;n<s.length;n++)s[n](e)}},r.random=new r.prng(6),function(){try{if(t&&t.crypto&&t.crypto.getRandomValues){var e=new Uint32Array(32);t.crypto.getRandomValues(e),r.random.addEntropy(e,1024,"crypto.getRandomValues")}}catch(t){}}(),r),s=function(){var t;function e(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function r(){return new e(null)}"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=function(t,e,r,n,i,s){for(var a=32767&e,o=e>>15;--s>=0;){var h=32767&this[t],c=this[t++]>>15,u=o*h+c*a;i=((h=a*h+((32767&u)<<15)+r[n]+(1073741823&i))>>>30)+(u>>>15)+o*c+(i>>>30),r[n++]=1073741823&h}return i},t=30):"Netscape"!=navigator.appName?(e.prototype.am=function(t,e,r,n,i,s){for(;--s>=0;){var a=e*this[t++]+r[n]+i;i=Math.floor(a/67108864),r[n++]=67108863&a}return i},t=26):(e.prototype.am=function(t,e,r,n,i,s){for(var a=16383&e,o=e>>14;--s>=0;){var h=16383&this[t],c=this[t++]>>14,u=o*h+c*a;i=((h=a*h+((16383&u)<<14)+r[n]+i)>>28)+(u>>14)+o*c,r[n++]=268435455&h}return i},t=28),e.prototype.DB=t,e.prototype.DM=(1<<t)-1,e.prototype.DV=1<<t;e.prototype.FV=Math.pow(2,52),e.prototype.F1=52-t,e.prototype.F2=2*t-52;var n,i,s="0123456789abcdefghijklmnopqrstuvwxyz",a=new Array;for(n="0".charCodeAt(0),i=0;i<=9;++i)a[n++]=i;for(n="a".charCodeAt(0),i=10;i<36;++i)a[n++]=i;for(n="A".charCodeAt(0),i=10;i<36;++i)a[n++]=i;function o(t){return s.charAt(t)}function h(t){var e=r();return e.fromInt(t),e}function c(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function u(t){this.m=t}function l(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}return u.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},u.prototype.revert=function(t){return t},u.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},u.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},u.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},l.prototype.convert=function(t){var n=r();return t.abs().dlShiftTo(this.m.t,n),n.divRemTo(this.m,null,n),t.s<0&&n.compareTo(e.ZERO)>0&&this.m.subTo(n,n),n},l.prototype.revert=function(t){var e=r();return t.copyTo(e),this.reduce(e),e},l.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],n=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,n,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},l.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},l.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},e.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},e.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},e.prototype.fromString=function(t,r){var n;if(16==r)n=4;else if(8==r)n=3;else if(256==r)n=8;else if(2==r)n=1;else if(32==r)n=5;else{if(4!=r)return void this.fromRadix(t,r);n=2}this.t=0,this.s=0;for(var i,s,o=t.length,h=!1,c=0;--o>=0;){var u=8==n?255&t[o]:(i=o,null==(s=a[t.charCodeAt(i)])?-1:s);u<0?"-"==t.charAt(o)&&(h=!0):(h=!1,0==c?this[this.t++]=u:c+n>this.DB?(this[this.t-1]|=(u&(1<<this.DB-c)-1)<<c,this[this.t++]=u>>this.DB-c):this[this.t-1]|=u<<c,(c+=n)>=this.DB&&(c-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,c>0&&(this[this.t-1]|=(1<<this.DB-c)-1<<c)),this.clamp(),h&&e.ZERO.subTo(this,this)},e.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},e.prototype.dlShiftTo=function(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s},e.prototype.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},e.prototype.lShiftTo=function(t,e){var r,n=t%this.DB,i=this.DB-n,s=(1<<i)-1,a=Math.floor(t/this.DB),o=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)e[r+a+1]=this[r]>>i|o,o=(this[r]&s)<<n;for(r=a-1;r>=0;--r)e[r]=0;e[a]=o,e.t=this.t+a+1,e.s=this.s,e.clamp()},e.prototype.rShiftTo=function(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e[0]=this[r]>>n;for(var a=r+1;a<this.t;++a)e[a-r-1]|=(this[a]&s)<<i,e[a-r]=this[a]>>n;n>0&&(e[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}},e.prototype.subTo=function(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this[r]-t[r],e[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],e[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],e[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[r++]=this.DV+n:n>0&&(e[r++]=n),e.t=r,e.clamp()},e.prototype.multiplyTo=function(t,r){var n=this.abs(),i=t.abs(),s=n.t;for(r.t=s+i.t;--s>=0;)r[s]=0;for(s=0;s<i.t;++s)r[s+n.t]=n.am(0,i[s],r,s,0,n.t);r.s=0,r.clamp(),this.s!=t.s&&e.ZERO.subTo(r,r)},e.prototype.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},e.prototype.divRemTo=function(t,n,i){var s=t.abs();if(!(s.t<=0)){var a=this.abs();if(a.t<s.t)return null!=n&&n.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=r());var o=r(),h=this.s,u=t.s,l=this.DB-c(s[s.t-1]);l>0?(s.lShiftTo(l,o),a.lShiftTo(l,i)):(s.copyTo(o),a.copyTo(i));var p=o.t,f=o[p-1];if(0!=f){var d=f*(1<<this.F1)+(p>1?o[p-2]>>this.F2:0),v=this.FV/d,m=(1<<this.F1)/d,g=1<<this.F2,y=i.t,b=y-p,_=null==n?r():n;for(o.dlShiftTo(b,_),i.compareTo(_)>=0&&(i[i.t++]=1,i.subTo(_,i)),e.ONE.dlShiftTo(p,_),_.subTo(o,o);o.t<p;)o[o.t++]=0;for(;--b>=0;){var E=i[--y]==f?this.DM:Math.floor(i[y]*v+(i[y-1]+g)*m);if((i[y]+=o.am(0,E,i,b,0,p))<E)for(o.dlShiftTo(b,_),i.subTo(_,i);i[y]<--E;)i.subTo(_,i)}null!=n&&(i.drShiftTo(p,n),h!=u&&e.ZERO.subTo(n,n)),i.t=p,i.clamp(),l>0&&i.rShiftTo(l,i),h<0&&e.ZERO.subTo(i,i)}}},e.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},e.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},e.prototype.exp=function(t,n){if(t>4294967295||t<1)return e.ONE;var i=r(),s=r(),a=n.convert(this),o=c(t)-1;for(a.copyTo(i);--o>=0;)if(n.sqrTo(i,s),(t&1<<o)>0)n.mulTo(s,a,i);else{var h=i;i=s,s=h}return n.revert(i)},e.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,n=(1<<e)-1,i=!1,s="",a=this.t,h=this.DB-a*this.DB%e;if(a-- >0)for(h<this.DB&&(r=this[a]>>h)>0&&(i=!0,s=o(r));a>=0;)h<e?(r=(this[a]&(1<<h)-1)<<e-h,r|=this[--a]>>(h+=this.DB-e)):(r=this[a]>>(h-=e)&n,h<=0&&(h+=this.DB,--a)),r>0&&(i=!0),i&&(s+=o(r));return i?s:"0"},e.prototype.negate=function(){var t=r();return e.ZERO.subTo(this,t),t},e.prototype.abs=function(){return this.s<0?this.negate():this},e.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0},e.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+c(this[this.t-1]^this.s&this.DM)},e.prototype.mod=function(t){var n=r();return this.abs().divRemTo(t,null,n),this.s<0&&n.compareTo(e.ZERO)>0&&t.subTo(n,n),n},e.prototype.modPowInt=function(t,e){var r;return r=t<256||e.isEven()?new u(e):new l(e),this.exp(t,r)},e.ZERO=h(0),e.ONE=h(1),e.int2char=o,e}(),a=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="=";function n(n){var i,s,a,o="",h=0;for(i=0;i<n.length&&n.charAt(i)!=r;++i)(s=e.indexOf(n.charAt(i)))<0||(0==h?(o+=t(s>>2),a=3&s,h=1):1==h?(o+=t(a<<2|s>>4),a=15&s,h=2):2==h?(o+=t(a),o+=t(s>>2),a=3&s,h=3):(o+=t(a<<2|s>>4),o+=t(15&s),h=0));return 1==h&&(o+=t(a<<2)),o}return{hex2b64:function(t){var n,i,s="";for(n=0;n+3<=t.length;n+=3)i=parseInt(t.substring(n,n+3),16),s+=e.charAt(i>>6)+e.charAt(63&i);for(n+1==t.length?(i=parseInt(t.substring(n,n+1),16),s+=e.charAt(i<<2)):n+2==t.length&&(i=parseInt(t.substring(n,n+2),16),s+=e.charAt(i>>2)+e.charAt((3&i)<<4));(3&s.length)>0;)s+=r;return s},b64tohex:n,b64toBA:function(t){var e,r=n(t),i=new Array;for(e=0;2*e<r.length;++e)i[e]=parseInt(r.substring(2*e,2*e+2),16);return i}}}(s.int2char),o=function(t,e,r){function n(t){var r;for(r=0;r<t.length;++r)t[r]=255&e.random.randomWords(1,0)[0]}function i(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return i.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},i.prototype.setPublic=function(e,r){if(!(null!=e&&null!=r&&e.length>0&&r.length>0))throw"Invalid RSA public key";this.n=new t(e,16),this.e=parseInt(r,16)},i.prototype.encrypt=function(e){var r=function(e,r){if(r<e.length+11)return null;for(var i=new Array,s=e.length-1;s>=0&&r>0;){var a=e.charCodeAt(s--);a<128?i[--r]=a:a>127&&a<2048?(i[--r]=63&a|128,i[--r]=a>>6|192):(i[--r]=63&a|128,i[--r]=a>>6&63|128,i[--r]=a>>12|224)}i[--r]=0;for(var o=new Array;r>2;){for(o[0]=0;0==o[0];)n(o);i[--r]=o[0]}return i[--r]=2,i[--r]=0,new t(i)}(e,this.n.bitLength()+7>>3);if(null==r)return null;var i=this.doPublic(r);if(null==i)return null;var s=i.toString(16);return 0==(1&s.length)?s:"0"+s},i.prototype.encrypt_b64=function(t){var e=this.encrypt(t);return e?r(e):null},i}(s,i,a.hex2b64);i.ignore=function(t){i.beware.hasOwnProperty(t)&&i.beware[t]()},n.prototype.extract=function(t){var e,r=[];for(e=0;e<this.sub.length;e++)this.sub[e].typeName()===t&&r.push(this.sub[e]);return r},n.prototype.contentAsHexString=function(t){return this.stream.hexDump(this.posContent(),this.posEnd()).replace(/[ \n]/g,"")};var h=function(){};h.prototype.getElement=function(e){return t.jQuery&&e instanceof t.jQuery?e[0]:e.nodeType&&1===e.nodeType?e:document.getElementById(e)},h.prototype.preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},h.prototype.addEventListener=function(t,e,r){t.addEventListener?t.addEventListener(e,r,!1):t.attachEvent&&t.attachEvent("on"+e,r)};var c=function(t){this.sjcl=t||i,this.key=this.sjcl.random.randomWords(8,0)};c.prototype.randomIV=function(){return this.sjcl.random.randomWords(4,0)},c.prototype.encrypt=function(t){var e=this.sjcl.codec.utf8String.toBits(t),r=new this.sjcl.cipher.aes(this.key),n=this.randomIV(),i=this.sjcl.mode.cbc.encrypt(r,e,n),s=this.sjcl.bitArray.concat(n,i);return{encryptedValue:i,ciphertext:this.sjcl.codec.base64.fromBits(s),key:this.key,iv:n}};var u=function(t){this.sjcl=t||i,this.Hash=i.hash.sha256,this.key=this.sjcl.random.randomWords(8,0)};u.prototype.sign=function(t){var e=new this.sjcl.misc.hmac(this.key,this.Hash).mac(t);return this.sjcl.codec.base64.fromBits(e)};var l=function(t,e,r){var n=new(e=e||p)((r=r||a).b64toBA(t)),i=new o,s=n.extractPublicKeyParts();return i.setPublic(s.modulus,s.exponent),i},p=function(t,e){e=e||n,this.asn1=e.decode(t),this.rsaEncryptionOID="2A864886F70D010101"};p.prototype.checkCertificate=function(){if("SEQUENCE"!==this.asn1.typeName())throw"Certificate is not in X.509 format";var t=this.asn1.extract("SEQUENCE")[0].extract("OBJECT_IDENTIFIER")[0].contentAsHexString();if(t!==this.rsaEncryptionOID)throw"Incorrect algorithm identifier "+t},p.prototype.extractPublicKeyParts=function(){var t=this.asn1.extract("BIT_STRING")[0].extract("SEQUENCE")[0].extract("INTEGER");return{modulus:t[0].contentAsHexString(),exponent:t[1].contentAsHexString()}};var f=function(t,e,r,n){this.rsaKey=t,this.sjcl=e||i,this.aesFactory=r||c,this.hmacFactory=n||u};f.prototype.encryptKeys=function(t,e){var r=this.sjcl.bitArray.concat(t,e),n=this.sjcl.codec.base64.fromBits(r);return this.rsaKey.encrypt_b64(n)},f.prototype.encrypt=function(t){var e=new this.aesFactory(this.libsjcl),r=new this.hmacFactory(this.libsjcl),n=e.encrypt(t).ciphertext,i=r.sign(n);return{keys:this.encryptKeys(e.key,r.key),ciphertext:n,signature:i}};var d=function(t,e,r,n){this.request.open(t,e),this.setHeaders(),void 0!==n&&n&&this.setupCallback(n),r=r||"";var i=null;/^(post)$/i.test(t)&&(i="data="+r),this.request.send(i)},v=function(t,e){this.support=t,this.timeout=e,this.name="XDomainRequest",this.request=new XDomainRequest};v.prototype.send=d,v.prototype.setHeaders=function(){this.request.timeout=this.timeout},v.prototype.setupCallback=function(t){var e=this.request;e.onload=function(){t.hasOwnProperty("success")&&t.success(e.responseText)},e.onerror=function(){t.hasOwnProperty("failure")&&t.failure(void 0)},this.support.timeout&&t.hasOwnProperty("timeout")&&(e.ontimeout=t.timeout)};var m=function(t,e){this.support=t,this.timeout=e,this.name="XMLHttpRequest",this.request=new XMLHttpRequest};m.prototype.send=d,m.prototype.setHeaders=function(){this.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.request.timeout=this.timeout},m.prototype.setupCallback=function(e){var r,n=this.request;e.hasOwnProperty("timeout")&&(this.support.timeout?n.ontimeout=e.timeout:r=setTimeout(e.timeout,this.timeout)),n.onreadystatechange=function(){var i;4==n.readyState&&(void 0!==r&&t.clearTimeout(r),(i=n.status)>=200&&i<300||304===i?e.hasOwnProperty("success")&&e.success(n.responseText):e.hasOwnProperty("failure")&&e.failure(n.status))}};var g=function(e){var r=function(){var e={xdr:!1,xhr:!1,timeout:!1};try{var r=new t.XMLHttpRequest;e.xhr="withCredentials"in r,e.timeout="timeout"in r}catch(t){e.xhr=!1}e.xhr||void 0!==t.XDomainRequest&&(e.xdr=!0,e.timeout=!0);return e}();if(e=e||8e3,r.xdr)return new v(r,e);if(r.xhr)return new m(r,e);throw"Your browser is not supported"};var y=function(t){this.version=t};y.prototype.serialise=function(t){return function(t){for(var e,r,n=["+"],i=0;i<n.length;i++){var s=encodeURIComponent(n[i]);e=n[i],r=s,t=t.replace(new RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),r)}return t}(JSON.stringify({version:this.version,value:t}))};var b=function(t,e,r){this.cryptoHandler=t,this.marshaller=e,this.requestFactory=r};b.prototype.sanitiseInput=function(t){return t.removeAttribute("name"),t},b.prototype.getCleartextFields=function(t){for(var e=[],r=E.dataAttrs.cleartext,n=t.querySelectorAll("["+r+"]"),i=0;i<n.length;i++){var s=n.item(i);e.push({name:s.name,value:s.value})}return e},b.prototype.getEncryptedFields=function(t){for(var e=[],r=E.dataAttrs.encrypted,n=t.querySelectorAll("["+r+"]"),i=0;i<n.length;i++){var s=this.sanitiseInput(n.item(i));e.push({name:s.getAttribute(r),value:this.cryptoHandler.encrypt(s.value)})}return e},b.prototype.getFields=function(t){return[].concat(this.getEncryptedFields(t),this.getCleartextFields(t))},b.prototype.tokenise=function(t,e,r,n){var i=this.getFields(t),s=this.marshaller.serialise(i);this.requestFactory(n).send("POST",e,s,r)},b.prototype.passthrough=function(t,e){if(e.hasOwnProperty("success")){var r=this.getFields(t);e.success(this.marshaller.serialise(r))}};var _=function(t){this.version=E.version,this.publicKey=t,this.url=void 0,this.timeout=void 0,this.tokenise=!1,i.ignore("CBC mode warning"),i.random.startCollectors()};_.prototype.validateForm=function(t,e,r){var n=(new h).getElement(t),i=E.dataAttrs.encrypted,s={name:n.querySelector("["+i+'="name"]'),number:n.querySelector("["+i+'="number"]'),cvc:n.querySelector("["+i+'="cvc"]'),month:n.querySelector("["+i+'="month"]'),year:n.querySelector("["+i+'="year"]'),date:n.querySelector("["+i+'="date"]')};new C(s,e,r)},_.prototype.validateEbanxForm=function(t,e){var r=(new h).getElement(t),n=E.dataAttrs.cleartext,i={ebanxname:r.querySelector("["+n+'="ebanxname"]'),document:r.querySelector("["+n+'="document"]'),email:r.querySelector("["+n+'="email"]'),phone:r.querySelector("["+n+'="phone"]'),address:r.querySelector("["+n+'="address"]'),streetno:r.querySelector("["+n+'="streetno"]'),streetcomplement:r.querySelector("["+n+'="streetcomplement"]'),city:r.querySelector("["+n+'="city"]'),zip:r.querySelector("["+n+'="zip"]')};new D(i,e)},_.prototype.encryptForm=function(t,e){var r=new l(this.publicKey),n=new b(new f(r),new y(this.version),g),i=new h;if(t=i.getElement(t),this.tokenise){var s=this;i.addEventListener(t,"submit",function(r){i.preventDefault(r),n.tokenise(t,s.url,e,s.timeout)})}else i.addEventListener(t,"submit",function(r){i.preventDefault(r),n.passthrough(t,e)});return t};var E={version:"0.1.2",dataAttrs:{encrypted:"data-fln-billing",cleartext:"data-fln-billing-cleartext"}},S={defaultCard:{name:"",pattern:/(\d{1,4}) ?(\d{1,4})? ?(\d{1,4})? ?(\d{1,4})?/,pan:[20],cvv:[5]},style:function(t){return t?"ok":!1===t?"err":""},validSubmit:function(t,e){return e.amount>0&&3===e.currencyCode.length&&t.pan.valid&&T(t)&&t.expiry.valid&&t.name.valid},serializeForm:function(t){return JSON.stringify({version:"0.1.2",value:t})},parseForm:function(t,e,r,n,i){var s=[{name:"csrf",value:encodeURIComponent(r)},{name:"domain",value:n},{name:"name",value:i.name},{name:"number",value:i.pan},{name:"cvc",value:i.cvv},{name:"month",value:i.expiry.month},{name:"year",value:i.expiry.year},{name:"expirymonth",value:t.expiry.month},{name:"expiryyear",value:t.expiry.year},{name:"amount",value:e.amount},{name:"currency",value:e.currencyCode},{name:"card",value:t.card.name},{name:"iin",value:t.iin},{name:"lastfour",value:t.last4},{name:"cardholdername",value:t.name.value}];for(var a in e.meta)s.push({name:a,value:e.meta[a]});return s},parseName:function(t,e){return{name:t,valid:0===t.length?void 0:e}},parseExpiry:function(t,e,r){var n=t.match(/(\d{1,2}) ?\/? ?(\d{1,2})?/)||[],i={month:n[1],year:!!n[2]&&"20"+n[2]};return i.parsed=i.year?n[1]+" / "+n[2]:t.replace(/[^\d\s\/]/g,""),i.year>=2e3&&(i.valid=e&&i.month>=1&&i.month<=12&&(i.year>r.getFullYear()||i.year==r.getFullYear()&&i.month>r.getMonth())),i},parseCvv:function(t,e){return{cvv:t.substr(0,4),valid:e}},parsePan:function(t,e){var r=e.replace(/\D/g,"").match(t.card.pattern)||[];return r.shift(),t.pan.value=r.join("").trim(),t.card=function(t){for(var e=[{cvv:[4],iinRegex:/^3[47]/,name:"amex",pan:[15],pattern:/(\d{1,4}) ?(\d{1,6})? ?(\d{1,5})?/},{cvv:[3],iinRegex:/^35(2[89]|[3-8][0-9])/,name:"jcb",pan:[16],pattern:S.defaultCard.pattern},{cvv:[3],iinRegex:/^(4026|417500|4508|4844|491(3|7))/,name:"visa_electron",pan:[16],pattern:S.defaultCard.pattern},{cvv:[3],iinRegex:/^4/,name:"visa",pan:[16],pattern:S.defaultCard.pattern},{cvv:[3],iinRegex:/^(5[1-5]|222[1-9]|22[3-9]|2[3-6]|27[01]|2720)/,name:"mastercard",pan:[16],pattern:S.defaultCard.pattern},{cvv:[3],iinRegex:/^((50670[7-8])|(506715)|(50671[7-9])|(50672[0-1])|(50672[4-9])|(50673[0-3])|(506739)|(50674[0-8])|(50675[0-3])|(50677[4-8])|(50900[0-9])|(50901[3-9])|(50902[0-9])|(50903[1-9])|(50904[0-9])|(50905[0-9])|(50906[0-4])|(50906[6-9])|(50907[0-2])|(50907[4-5])|(636368)|(636297)|(504175)|(438935)|(40117[8-9])|(45763[1-2])|(457393)|(431274)|(50907[6-9])|(50908[0-9])|(627780))/,name:"elo",pan:[16],pattern:S.defaultCard.pattern},{cvv:[3],iinRegex:/^606282|637095|637568|38[0-9]/,name:"hipercard",pan:[16,17,18,19],pattern:/(\d{1,4}) ?(\d{1,4})? ?(\d{1,4})? ?(\d{1,4})? ?(\d{1,3})?/},{cvv:[3],iinRegex:/^(286900|502275|506(199|2(0[1-6]|1[2-578]|2[289]|3[67]|4[579]|5[01345789]|6[12359]|7[02-9]|8[0-47]|9[479])|3(0[0-79]|1[1-49]|2[039]|3[02-79]|4[0-49]|5[0-79]|6[014-79]|7[0-49]|8[023467]|9[124])|402)|606333|636379|639(388|484|559)|588772(02|66|67|68|74|84)|6046220[34])/,name:"carnet",pan:[16],pattern:S.defaultCard.pattern},{cvv:[3],iinRegex:/^5[0-9]/,name:"aura",pan:[16],pattern:S.defaultCard.pattern}],r=0;r<e.length;++r)if(e[r].iinRegex.test(t))return e[r];return S.defaultCard}(t.iin=t.pan.value.substr(0,6)),t.pan.valid=t.card.pan.indexOf(t.pan.value.length)<0?void 0:x(t.pan.value),t.last4=void 0===t.pan.valid?"":t.pan.value.substr(t.pan.value.length-4),r.join(" ").trim()},notify:function(t){return{card:t.card.name,iin:t.iin,last4:t.last4,pan:{length:t.pan.value.length,valid:t.pan.valid},cvv:{length:t.cvv.value.length,valid:T(t)}}}};function T(t){if(t.cvv.value)return!!t.cvv.valid&&(t.card.cvv.indexOf(t.cvv.value.length)>=0||void 0)}function x(t){for(var e=0,r=t.split("").reverse(),n=0;n<r.length;n++){var i=parseInt(r[n],10);e+=n%2!=0?(i*=2)<10?i:i-9:i}return 0!==e&&e%10==0}var w=function(t){this.name=void 0,this.number=void 0,this.cvc=void 0,this.month=NaN,this.year=NaN,this.date=void 0,this.cardTypeIndex=void 0,this.cardTypes=[],this.expiryDateFormat=/(\d{2})(?:\D*)?(\d{1,2})?/;var e="The last 3 digits displayed on the back of your card",r=/(\d{1,4})(\d{1,4})?(\d{1,4})?(\d{1,4})?/,n=[{name:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,validLengths:[15],cvcLength:[4],cvcMessage:"The 4 digits displayed on the front of your card"},{name:"diners_club_carte_blanche",pattern:/^30[0-5]/,format:void 0,validLengths:[14],cvcLength:[3],cvcMessage:void 0},{name:"diners_club_international",pattern:/^36/,format:void 0,validLengths:[14],cvcLength:[3],cvcMessage:void 0},{name:"jcb",pattern:/^35(2[89]|[3-8][0-9])/,format:r,validLengths:[16],cvcLength:[3],cvcMessage:void 0},{name:"laser",pattern:/^(6304|670[69]|6771)/,format:void 0,validLengths:[16,17,18,19],cvcLength:[3],cvcMessage:void 0},{name:"visa_electron",pattern:/^(4026|417500|4508|4844|491(3|7))/,format:r,validLengths:[16],cvcLength:[3],cvcMessage:e},{name:"visa",pattern:/^4/,format:r,validLengths:[16],cvcLength:[3],cvcMessage:e},{name:"carnet",pattern:/^(286900|502275|506(199|2(0[1-6]|1[2-578]|2[289]|3[67]|4[579]|5[01345789]|6[12359]|7[02-9]|8[0-47]|9[479])|3(0[0-79]|1[1-49]|2[039]|3[02-79]|4[0-49]|5[0-79]|6[014-79]|7[0-49]|8[023467]|9[124])|402)|606333|636379|639(388|484|559)|588772|604622)/,format:r,validLengths:[16],cvcLength:[3],cvcMessage:e},{name:"aura",pattern:/^5[0-9]/,format:r,validLengths:[16],cvcLength:[3],cvcMessage:e},{name:"mastercard",pattern:/^(5[1-5]|222[1-9]|22[3-9]|2[3-6]|27[01]|2720)/,format:r,validLengths:[16],cvcLength:[3],cvcMessage:e},{name:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,format:void 0,validLengths:[12,13,14,15,16,17,18,19],cvcLength:[3],cvcMessage:void 0},{name:"discover",pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,format:r,validLengths:[16],cvcLength:[3],cvcMessage:e},{name:"elo",pattern:/^((50670[7-8])|(506715)|(50671[7-9])|(50672[0-1])|(50672[4-9])|(50673[0-3])|(506739)|(50674[0-8])|(50675[0-3])|(50677[4-8])|(50900[0-9])|(50901[3-9])|(50902[0-9])|(50903[1-9])|(50904[0-9])|(50905[0-9])|(50906[0-4])|(50906[6-9])|(50907[0-2])|(50907[4-5])|(636368)|(636297)|(504175)|(438935)|(40117[8-9])|(45763[1-2])|(457393)|(431274)|(50907[6-9])|(50908[0-9])|(627780))/,format:r,validLengths:[16],cvcLength:[3],cvcMessage:e},{name:"hipercard",pattern:/^((606282|637095|637568)|38[0-9]{4})/,format:/(\d{1,4})(\d{1,4})?(\d{1,4})?(\d{1,4})?(\d{1,3})?/,validLengths:[16,17,18,19],cvcLength:[3],cvcMessage:e}];if(void 0===t)this.cardTypes=n;else for(var i=0;i<t.length;i++)for(var s=0;s<n.length;s++)if(t[i]===n[s].name){this.cardTypes.push(n[s]);break}};w.prototype.setName=function(t){this.name=t},w.prototype.setNumber=function(t){this.number=t.replace(/\D/g,""),this.cardTypeIndex=void 0;for(var e=0;e<this.cardTypes.length;e++)this.number.match(this.cardTypes[e].pattern)&&(this.cardTypeIndex=e)},w.prototype.setCVC=function(t){this.cvc=t},w.prototype.setMonth=function(t){this.month=parseInt(t,10)},w.prototype.setYear=function(t){this.year=parseInt(t,10),!isNaN(this.year)&&this.year>=0&&this.year<100&&(this.year+=2e3)},w.prototype.setDate=function(t){this.date=t},w.prototype.setMonthYear=function(){if(void 0!==this.date){var t=this.date.replace(/[^\d\s\/]/g,""),e=this.expiryDateFormat.exec(this.date);if(null!==e){e.shift();var r=e[0],n=e[1];void 0!==r&&r!=this.month&&(this.setMonth(r),this.isMonthValid()||this.setMonth()),void 0!==n&&n!=this.year&&(this.setYear(n),this.isMonthValid()||this.setMonth(),t=e.join(" / ").replace(/^\s+|\s+$/g,""))}return this.date!=t?t:void 0}},w.prototype.getCardType=function(){if(void 0!==this.cardTypeIndex)return this.cardTypes[this.cardTypeIndex]},w.prototype.getFormattedNumber=function(){var t=this.getCardType();if(void 0===t||void 0===t.format)return this.number;var e=t.format.exec(this.number);return null===e?this.number:(e.shift(),e.join(" ").replace(/^\s+|\s+$/g,""))},w.prototype.getIIN=function(){if(!(void 0===this.number||this.number.length<6))return this.number.slice(0,6)},w.prototype.getLastFour=function(){if(this.isLengthValid())return this.number.slice(-4)},w.prototype.isCardTypeValid=function(){return void 0!==this.getCardType()},w.prototype.isLuhnValid=function(){return x(this.number)},w.prototype.isLengthValid=function(){var t=this.getCardType();if(void 0===t)return!1;for(var e=0;e<t.validLengths.length;e++)if(t.validLengths[e]==this.number.length)return!0;return!1},w.prototype.isCVCValid=function(){var t=this.getCardType();if(void 0!==t&&void 0!==this.cvc){for(var e=0;e<t.cvcLength.length;e++)if(t.cvcLength[e]==this.cvc.length)return!0;return!1}},w.prototype.isExpiryValid=function(){if(!isNaN(this.month)&&!isNaN(this.year)){if(!this.isMonthValid()||!this.isYearValid())return!1;var t=new Date;return this.year>t.getFullYear()||this.year==t.getFullYear()&&this.month>t.getMonth()}},w.prototype.isMonthValid=function(){return this.month>=1&&this.month<=12},w.prototype.isYearValid=function(){var t=new Date;return this.year>=t.getFullYear()},w.prototype.isValid=function(){return!0===(this.isLengthValid()&&this.isLuhnValid()&&this.isCVCValid()&&this.isExpiryValid())};var C=function(t,e,r){(r=r||{}).accepted=r.accepted||void 0;var n=new w(r.accepted);e.success=e.success||function(){},e.error=e.error||function(){},e.info=e.info||function(){};var i={name:{events:["change","keyup","paste","cut","blur"],validation:function(t,e){n.setName(e);var r=e.length>0,i="";return e.length>0?r="keyup"!==t.type||"info":i="This field is required",{success:r,message:i,meta:s(n)}}},number:{events:["change","keyup","paste","cut","blur"],validation:function(e,r){n.setNumber(r);var i,a=!1;"keyup"==e.type&&(37==e.keyCode||39==e.keyCode||9==e.keyCode)?a=void 0:n.isCardTypeValid()?n.isLengthValid()?n.isLuhnValid()?a=!0:i="The number entered is invalid":"keyup"===e.type?a="info":i="The number entered is the wrong length":r.length>=4?i="Unsupported card type":0===r.length?i="This field is required":a="info";var o,h,c=function(e){for(var r in t)if(r==e)return t[e];return}("cvc");return o=c,document.createEvent?((h=document.createEvent("Event")).initEvent("change",!0,!0),o.dispatchEvent(h)):((h=document.createEventObject()).eventType="change",o.fireEvent("on"+h.eventType,h)),{success:a,message:i,meta:s(n)}}},cvc:{events:["change","keyup","paste","cut","blur"],validation:function(t,e){n.setCVC(e);var r=n.isCVCValid(),i=e.length<3&&"keyup"==t.type;return 0!==e.length&&n.isCardTypeValid()?i&&(r="info"):r=void 0,{success:r,message:r?"":"CVC entered is the wrong length",meta:s(n)}}},month:{events:["change","click","keyup"],validation:function(t,e){n.setMonth(e);var r=n.isExpiryValid();return{success:r,message:r?"":"Expiry date entered is invalid",meta:s(n)}}},year:{events:["change","click","keyup"],validation:function(t,e){n.setYear(e);var r=n.isExpiryValid();return{success:r,message:r?"":"Expiry date entered is invalid",meta:s(n)}}},date:{events:["change","keyup","paste","cut","blur"],validation:function(t,e){n.setDate(e);var r="keyup"==t.type&&(37==t.keyCode||39==t.keyCode||9==t.keyCode),i=!1,a=s(n),o="Invalid expiry date";return r?i=void 0:n.isExpiryValid()?i=!0:e.length<7&&"keyup"===t.type?i="info":0===e.length?o="This field is required":i=!1,{success:i,message:i?"":o,meta:a}}}};function s(t){var e=t.getCardType(),r={};return void 0!==e&&(r.card=e.name,r.cvcMessage=e.cvcMessage),r.formattedNumber=t.getFormattedNumber(),r.iin=t.getIIN(),r.lastFour=t.getLastFour(),r.expiryDate=t.setMonthYear(),t.isExpiryValid()&&(r.expiryYear=t.year,r.expiryMonth=t.month),r.cardholderName=t.name,r}function a(t,r,i){var s=function(r){var s=i(r,t.value),a={allValid:n.isValid(),target:t,message:s.message,meta:s.meta};void 0!==s.success&&(!0===s.success?e.success(a):!1===s.success?e.error(a):"info"===s.success&&e.info(a))};t.addEventListener?t.addEventListener(r,s,!1):t.attachEvent&&t.attachEvent("on"+r,s)}!function(){for(var e in t){var r=t[e];if(null!==r)for(var n in i)if(e==n)for(var s=0;s<i[e].events.length;s++){a(r,i[e].events[s],i[e].validation)}}}()},D=function(t,e){var r=!t.address,n=!t.document,i=!t.email,s=!t.phone,a=!t.address,o=!t.streeno,h=!t.city,c=!t.zip;e.success=e.success||function(){},e.error=e.error||function(){},e.info=e.info||function(){};var u={ebanxname:{events:["change","keyup","paste","cut","blur","focus","onfocus"],validation:function(t,e){var n=e.trim().length,i=n>0,s=e.length<3&&"keyup"==t.type;return 0===n?r=!1:s&&(i="info"),r=!0===i,{success:i,message:i?"":"Name field is required"}}},document:{events:["change","keyup","paste","cut","blur"],validation:function(t,e){var r=e.trim().length,i=r>10&&r<=16;return e.length<11&&"keyup"==t.type&&(i="info"),n=!0===i,{success:i,message:i?"":"Document field is invalid"}}},email:{events:["change","keyup","paste","cut","blur"],validation:function(t,e){var r=e.trim().length,n=null!==e.match(/^\S+@\S+\.\S+$/),s=r>0&&n,a="Phone field is invalid";return"keyup"==t.type&&(s="info"),!1===n&&(a="Email field is invalid"),i=!0===s,{success:s,message:s?"":a}}},phone:{events:["change","keyup","paste","cut","blur"],validation:function(t,e){var r=e.trim().length,n=!1,i=r<1&&"keyup"===t.type,a="Phone field is required",o=null!==e.match(/^\+?\d{6,16}$/);return r>0&&(r>4&&o&&(n=!0),i&&(n="info"),a="Phone field is invalid"),s=!0===n,{success:n,message:n?"":a}}},address:{events:["change","click","keyup"],validation:function(t,e){var r=e.trim().length>0;return a=!0===r,{success:r,message:r?"":"Address field is required"}}},streetno:{events:["change","click","keyup"],validation:function(t,e){var r=e.trim().length>0;return o=!0===r,{success:r,message:r?"":"Street Number field is required"}}},streetcomplement:{events:["change","click","keyup"],validation:function(t,e){return{success:!0,message:""}}},city:{events:["change","click","keyup"],validation:function(t,e){var r=e.trim().length>0;return h=!0===r,{success:r,message:r?"":"City field is required"}}},state:{events:["change","click","keyup"],validation:function(t,e){return{success:!0,message:""}}},zip:{events:["change","click","keyup"],validation:function(t,e){var r=e.trim().length>0;return c=!0===r,{success:r,message:r?"":"Zip field is required"}}}};function l(t,u,l){var p=function(u){var p=l(u,t.value),f={allValid:r&&n&&i&&s&&a&&o&&h&&c,target:t,message:p.message};void 0!==p.success&&(!0===p.success?e.success(f):!1===p.success?e.error(f):"info"===p.success&&e.info(f))};t.addEventListener?t.addEventListener(u,p,!1):t.attachEvent&&t.attachEvent("on"+u,p)}!function(){for(var e in t){var r=t[e];if(null!==r)for(var n in u)if(e==n)for(var i=0;i<u[e].events.length;i++){l(r,u[e].events[i],u[e].validation)}}}()};t.FreelancerBilling=_,t.CryptoHandlerFactory=f,t.RSAKeyFactory=l,t.sjcl=i,t.Hosted=S}(window);